import { readdirSync, writeFileSync, mkdirSync, existsSync } from 'node:fs';
import { basename } from 'node:path';
import slugify from 'slugify';
const pdfDir='pdfs', out='portfolio', img='imgs';mkdirSync(out,{recursive:true});
const cards=[];readdirSync(pdfDir).filter(f=>f.endsWith('.pdf')).forEach(p=>{const slug=slugify(basename(p,'.pdf'),{lower:true,strict:true});const dir=`${img}/${slug}`;if(!existsSync(dir))return;const pages=readdirSync(dir).filter(x=>x.endsWith('.webp')).length;const imgs=Array.from({length:pages}).map((_,i)=>`<img loading="lazy" src="../${dir}/page-${String(i+1).padStart(3,'0')}.webp">`).join('');writeFileSync(`${out}/${slug}.html`,`<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><title>${basename(p,'.pdf')}</title><link rel="stylesheet" href="../src/styles.css"></head><body><main class="container">${imgs}</main></body></html>`);cards.push(`<article class="pf-card"><h3 class="pf-title">${basename(p,'.pdf')}</h3><a class="btn" href="portfolio/${slug}.html">Открыть</a></article>`);});writeFileSync('portfolio.html',`<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><title>Портфолио</title><link rel="stylesheet" href="src/styles.css"></head><body><main class="container"><h1 style="text-align:center">Портфолио</h1><div class="cards-grid">${cards.join('')}</div></main></body></html>`);